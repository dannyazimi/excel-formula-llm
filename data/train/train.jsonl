{"input":{"task":"Sum Revenue where Region is East and Type is Sale","table_name":"Table1","columns":["Date","Region","Revenue","Type"],"sample_rows":[{"Date":"2025-11-02","Region":"East","Revenue":1200,"Type":"Sale"},{"Date":"2025-11-03","Region":"East","Revenue":-200,"Type":"Refund"},{"Date":"2025-11-04","Region":"West","Revenue":900,"Type":"Sale"}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":[],"assumptions":["Data is in an Excel Table named Table1 with columns Date, Region, Revenue, Type."],"formula":{"excel":"=SUMIFS(Table1[Revenue],Table1[Region],\"East\",Table1[Type],\"Sale\")","google_sheets":null},"explanation":[{"part":"SUMIFS","meaning":"Adds Revenue values that match all conditions."},{"part":"Region condition","meaning":"Keeps only rows where Region equals East."},{"part":"Type condition","meaning":"Keeps only rows where Type equals Sale."}],"warnings":[],"alternatives":[],"confidence":0.85}}
{"input":{"task":"Total Revenue for West region last month","table_name":"Sales","columns":["Date","Region","Revenue","Type"],"sample_rows":[{"Date":"2025-10-15","Region":"West","Revenue":800,"Type":"Sale"},{"Date":"2025-11-02","Region":"West","Revenue":1200,"Type":"Sale"},{"Date":"2025-11-05","Region":"East","Revenue":900,"Type":"Sale"}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":[],"assumptions":["Data is stored in an Excel Table named Sales.","Dates use calendar months."],"formula":{"excel":"=SUMIFS(Sales[Revenue],Sales[Region],\"West\",Sales[Date],\">=\"&EOMONTH(TODAY(),-2)+1,Sales[Date],\"<=\"&EOMONTH(TODAY(),-1))","google_sheets":null},"explanation":[{"part":"SUMIFS","meaning":"Adds Revenue values that meet all specified conditions."},{"part":"Region filter","meaning":"Keeps only rows where Region is West."},{"part":"Date filter","meaning":"Limits rows to the previous calendar month."}],"warnings":[],"alternatives":[],"confidence":0.81}}
{"input":{"task":"Count how many orders are marked Completed","table_name":"Orders","columns":["OrderID","Status","Amount"],"sample_rows":[{"OrderID":101,"Status":"Completed","Amount":250},{"OrderID":102,"Status":"Pending","Amount":400},{"OrderID":103,"Status":"Completed","Amount":150}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":[],"assumptions":["Each row represents a single order."],"formula":{"excel":"=COUNTIFS(Orders[Status],\"Completed\")","google_sheets":null},"explanation":[{"part":"COUNTIFS","meaning":"Counts rows that meet one or more conditions."},{"part":"Status condition","meaning":"Counts only rows where Status is Completed."}],"warnings":[],"alternatives":[],"confidence":0.88}}
{"input":{"task":"Show High if Revenue is at least 1000, otherwise Low","table_name":"Invoices","columns":["InvoiceID","Revenue"],"sample_rows":[{"InvoiceID":1,"Revenue":1200},{"InvoiceID":2,"Revenue":750},{"InvoiceID":3,"Revenue":1800}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":[],"assumptions":["Formula will be entered in a calculated column within the Invoices table."],"formula":{"excel":"=IF([@Revenue]>=1000,\"High\",\"Low\")","google_sheets":null},"explanation":[{"part":"IF","meaning":"Checks a condition and returns different values based on the result."},{"part":"Revenue threshold","meaning":"Labels Revenue values of 1000 or more as High."}],"warnings":[],"alternatives":[],"confidence":0.9}}
{"input":{"task":"Find Customer Name using Customer ID","table_name":"Sales","columns":["CustomerID","OrderAmount"],"sample_rows":[{"CustomerID":2001,"OrderAmount":500},{"CustomerID":2002,"OrderAmount":900},{"CustomerID":2003,"OrderAmount":300}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":["Which table contains the Customer Name to look up?"],"assumptions":[],"formula":{"excel":null,"google_sheets":null},"explanation":[],"warnings":[],"alternatives":[],"confidence":0.46}}
{"input":{"task":"Sum Revenue where Notes contains the word urgent","table_name":"Tickets","columns":["Notes","Revenue"],"sample_rows":[{"Notes":"urgent follow up needed","Revenue":300},{"Notes":"standard request","Revenue":150},{"Notes":"urgent escalation","Revenue":500}],"constraints":{"excel_version":"365","locale":"en-US"}},"output":{"clarifying_questions":[],"assumptions":["Text matching should be case-insensitive."],"formula":{"excel":"=SUMPRODUCT(--ISNUMBER(SEARCH(\"urgent\",Tickets[Notes])),Tickets[Revenue])","google_sheets":null},"explanation":[{"part":"SEARCH","meaning":"Finds text regardless of letter case."},{"part":"SUMPRODUCT","meaning":"Adds Revenue values where the text condition is true."}],"warnings":[],"alternatives":[],"confidence":0.77}}